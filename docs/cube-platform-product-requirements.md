# 魔方学习平台产品需求文档（PRD）

> **项目名称**：魔方学习平台
> **版本**：v1.1
> **日期**：2025年2月19日

## 1. 项目概述

### 1.1 背景

魔方爱好者，从初学者到高级玩家，需要一个集学习、练习和进阶功能于一体的平台。这个项目旨在打造一个全栈应用，支持多平台访问（PC 和移动端），从核心功能开始，逐步扩展到智能魔方硬件集成。

### 1.2 目标

- 打造一个包含魔方教程、用户进度管理、智能魔方联动的综合平台。
- 分阶段交付功能，确保每个阶段独立可用，降低开发风险。
- 支持单人开发工作流，同时符合企业级 DevOps 标准（版本控制、CI/CD、测试、监控）。

### 1.3 目标用户

| **用户类型** | **核心需求**                                      |
|--------------|-------------------------------------------------|
| **初学者**   | 系统化的教程、直观的 3D 公式演示、步骤分解学习       |
| **中级玩家** | 多种解法对比（如 CFOP、桥式）、公式分类、进度追踪    |
| **高级玩家** | 智能魔方在线对战、自定义公式上传、多端数据同步       |

## 2. 功能需求

### 第一阶段：核心功能（MVP）

#### 2.1.1 功能描述

1. **教程展示**
   - 分类：层先法、CFOP、桥式。
   - 按步骤展示公式和文字说明。
   - 交互式 3D 魔方模型（支持旋转、步骤回放）。

2. **3D 模型交互**

   - 使用 **Three.js** 渲染，支持手动拖拽旋转或自动播放公式步骤。

#### 2.1.2 技术实现

- **前端**：**Vue3** + **Vue Router** + **Three.js** + **Pinia**（状态管理）。
- **数据格式**：JSON 存储公式步骤（例如：`{ "steps": ["U", "R", "F'"] }`）。

### 第二阶段：用户功能增强

#### 2.2.1 功能描述

1. **用户系统**
   - 支持注册/登录（使用 **JWT** 认证）。  
   - 个人中心：公式标注、分类、收藏夹。  
2. **公式管理**  
   - 用户可标记公式难度和掌握程度。  
   - 支持上传自定义解法。  

#### 2.2.2 技术实现

- **后端**：**Node.js** + **Express** + **MongoDB**（通过 Mongoose ODM）。
- **数据库设计**：

  ```json
  {
    "_id": ObjectId,
    "username": "user1",
    "password": "hashed_password",
    "formulas": [
      { "formula_id": "F001", "tags": ["已掌握", "困难"], "custom_steps": [] }
    ]
  }
  ```

### 第三阶段：智能魔方集成（需评估可行性）

#### 2.3.1 功能描述

1. **硬件对接**
   - 通过蓝牙连接智能魔方（如 GAN、魔域）。
   - 将魔方转动数据同步到平台。
2. **在线对战**
   - 实时多人对战（通过 **WebSocket** 实现）。
   - 记录对战成绩。

#### 2.3.2 技术实现与风险

- **技术**：**Socket.io** 用于实时通信。
- **风险**：依赖智能魔方厂商的 API（如 GAN SDK）。
- **应对措施**：初期使用模拟数据；调研 GAN API 可用性（参考 [GAN 智能魔方官网](https://www.gancube.com/collections/smart-cubes)）。

### 第四阶段：多端扩展

#### 2.4.1 功能描述

1. **微信小程序**
   - 复用核心逻辑，基于 **Taro** 框架开发。
2. **移动端 App**
   - 使用 **React Native** 开发，共享约 80% 业务代码。

#### 2.4.2 技术实现

- 第一阶段的 H5 页面采用响应式设计，为移动端适配打基础。

## 3. 非功能需求

### 3.1 性能

- 3D 模型加载时间 ≤ 1 秒（使用 **WebGL** 优化，静态资源通过 **CDN** 加速）。
- 支持高并发访问，后端可扩展（如 MongoDB 分片）。

### 3.2 安全性

- 用户密码使用 **bcrypt** 加密存储。
- **JWT** 有效期 ≤ 24 小时，支持多因素认证（MFA）。
- 数据静态加密（使用 AES-256）和传输加密（**HTTPS**）。
- 符合 GDPR 等隐私合规要求。

### 3.3 兼容性

- PC 端支持 **Chrome**、**Firefox**、**Safari**。
- H5 适配 **iOS** 和 **Android** 主流机型。

### 3.4 可扩展性

- 数据库支持分片和索引优化，应对用户增长。
- 建议使用云服务（如 AWS 或 Google Cloud）简化服务器管理。

### 3.5 无障碍与国际化

- 支持多语言（如通过 **i18n** 实现）。
- 符合 WCAG 无障碍标准（如键盘导航、屏幕阅读器支持）。

## 4. 技术选型

| **模块**   | **技术方案**                                                     |
|------------|----------------------------------------------------------------|
| **前端**   | **Vue3** + **JavaScript** + **Pinia** + **Three.js**            |
| **后端**   | **Node.js** + **Express** + **MongoDB**（Mongoose ODM）         |
| **部署**   | **Docker** 容器化 + **Nginx** 反向代理 + **GitHub Actions CI/CD** |
| **测试**   | **Jest**（单元测试）+ **Cypress**（E2E 测试）+ **Postman**（API 测试） |
| **监控**   | **Prometheus**（性能监控）+ **ELK Stack**（日志分析）            |

## 5. 开发计划

### 5.1 第一阶段：核心功能开发（6 周）

| **周** | **任务**            | **交付物**                          | **验收标准**                |
|--------|-------------------|------------------------------------|---------------------------|
| 1-2    | 项目初始化 + 3D 渲染 | **Vue3** 项目模板、3D 模型演示页面 | 魔方模型可旋转/播放公式      |
| 3-4    | 教程页面开发         | 层先法、CFOP、桥式教程页面         | 步骤切换与 3D 模型同步更新   |
| 5-6    | 性能优化 + 文档      | 文档站点（GitHub Pages）、测试报告  | 首屏加载 ≤ 1s，无卡顿       |

### 5.2 第二阶段：用户系统开发（4 周）

| **周** | **任务**            | **交付物**                          | **验收标准**                |
|--------|-------------------|------------------------------------|---------------------------|
| 1      | 后端 API 开发       | **Node.js** API（Postman 测试通过） | 支持 **JWT** 和用户存储     |
| 2-3    | 前端用户界面         | 用户中心页面（公式管理功能）         | 与后端 API 实时同步         |
| 4      | 测试与优化          | 完整用户系统（测试覆盖率 ≥ 80%）    | 支持公式标注和自定义上传     |

### 5.3 后续阶段

- **第三阶段**：智能魔方集成（待 API 调研后规划）。
- **第四阶段**：多端扩展（根据 MVP 反馈调整）。

## 6. 风险与应对措施

1. **3D 性能问题**
   - **应对**：使用 **Three.js** 的 `GLTFLoader`加载轻量模型，启用 **WebGL** 压缩纹理。
2. **智能魔方接口缺失**
   - **应对**：初期模拟硬件数据，降低依赖风险；优先调研 GAN API。
3. **单人开发时间不足**
   - **应对**：延长开发周期，使用自动化工具（如 GitHub Actions）提升效率。
4. **多端兼容性**
   - **应对**：第一阶段采用响应式布局（**Flex** + **Grid**），提前测试移动端。

## 7. DevOps 实践

- **版本控制**：使用 GitHub 管理代码和文档，分支策略（如 `feature/phase1`）。
- **CI/CD**：通过 **GitHub Actions** 自动化测试和部署。
- **测试策略**：单元测试（**Jest**，覆盖率 ≥ 80%）、E2E 测试（**Cypress**）、性能测试（**Lighthouse**）。
- **监控与日志**：部署 **Prometheus** 监控性能，**ELK Stack** 分析日志。
- **编码规范**：遵循 Airbnb JavaScript 风格指南，使用 **ESLint** 检查代码。

## 8. 附录：资源推荐

1. **开发工具**
   - **VS Code** 插件：**Volar**（Vue3 支持）、**REST Client**（API 测试）。
2. **学习资源**
   - **Three.js** 入门：[Three.js Journey](https://threejs-journey.com/)
   - **JWT** 实战：[JWT Introduction](https://jwt.io/introduction/)
3. **项目管理**
   - **GitHub Projects**：启用 Kanban 跟踪任务进展。
